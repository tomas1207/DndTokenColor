{"name":"Action Tracker","type":"script","author":"GkBqYHWkQyR3h49f","img":"icons/magic/time/arrows-circling-pink.webp","scope":"global","command":"const actors = canvas.tokens._hover? [canvas.tokens._hover.actor] : canvas.tokens.controlled.flatMap((token) => token.actor ?? []);\nif (!actors.length && game.user.character) {\n    actors.push(game.user.character);\n}\nconst ITEM_UUID = 'Compendium.pf2e-color-effects.pf2e-color-effects.dqeDj2yTtQhUsWtE'; // Action Tracker\nconst source = (await fromUuid(ITEM_UUID)).toObject();\nsource.flags.core ??= {};\nsource.flags.core.sourceId = ITEM_UUID;\nfor await (const actor of actors) {\n    const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === ITEM_UUID);\n    if (existing) {\n        await existing.delete();\n    } else {\n        await actor.createEmbeddedDocuments('Item', [source]);\n    }\n}","folder":null,"sort":0,"permission":{"default":0,"GkBqYHWkQyR3h49f":3},"flags":{"core":{"sourceId":"Macro.4q0GOphe4b5vEaHP"}},"_id":"3nP4PRUsyA5rKFfH"}
{"name":"Apply Color","type":"script","author":"GkBqYHWkQyR3h49f","img":"modules/pf2e-color-effects/assets/color.webp","scope":"global","command":"const actors = canvas.tokens._hover? [canvas.tokens._hover.actor] : canvas.tokens.controlled.flatMap((token) => token.actor ?? []);\nif (!actors.length && game.user.character) {\n    actors.push(game.user.character);\n}\nconst ITEM_UUID = 'Compendium.pf2e-color-effects.pf2e-color-effects.JbQdqXdlANwhb802'; // Apply Color\nconst source = (await fromUuid(ITEM_UUID)).toObject();\nsource.flags.core ??= {};\nsource.flags.core.sourceId = ITEM_UUID;\nfor await (const actor of actors) {\n    const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === ITEM_UUID);\n    if (existing) {\n        await existing.delete();\n    } else {\n        await actor.createEmbeddedDocuments('Item', [source]);\n    }\n}","folder":null,"sort":0,"permission":{"default":0,"GkBqYHWkQyR3h49f":3},"flags":{"core":{"sourceId":"Macro.0WCNlqiuOxCNeDqF"}},"_id":"F25TWXtxJbh0iqwL"}
{"name":"ColorCounter","type":"script","author":"GkBqYHWkQyR3h49f","img":"modules/pf2e-color-effects/assets/ColorCounter.webp","scope":"global","command":"const actors = canvas.tokens._hover? [canvas.tokens._hover.actor] : canvas.tokens.controlled.flatMap((token) => token.actor ?? []);\nif (!actors.length && game.user.character) {\n    actors.push(game.user.character);\n}\nconst ITEM_UUID = 'Compendium.pf2e-color-effects.pf2e-color-effects.7IxFP90TqW54yK47'; // ColorCounter\nconst source = (await fromUuid(ITEM_UUID)).toObject();\nsource.flags.core ??= {};\nsource.flags.core.sourceId = ITEM_UUID;\nfor await (const actor of actors) {\n  await actor.createEmbeddedDocuments('Item', [source]);\n}","folder":null,"sort":0,"permission":{"default":0,"GkBqYHWkQyR3h49f":3},"flags":{"core":{"sourceId":"Macro.e5RGT2JGDD7NGmcV"}},"_id":"u5611YN21ziuvXZo"}
{"name":"Apply Number","type":"script","author":"GkBqYHWkQyR3h49f","img":"modules/pf2e-color-effects/assets/questionmark.webp","scope":"global","command":"const actors = canvas.tokens._hover? [canvas.tokens._hover.actor] : canvas.tokens.controlled.flatMap((token) => token.actor ?? []);\nif (!actors.length && game.user.character) {\n    actors.push(game.user.character);\n}\nconst ITEM_UUID = 'Compendium.pf2e-color-effects.pf2e-color-effects.gQJ5mdKYTISAQFNo'; // Counter\nconst source = (await fromUuid(ITEM_UUID)).toObject();\nsource.flags.core ??= {};\nsource.flags.core.sourceId = ITEM_UUID;\nfor await (const actor of actors) {\n    const existing = actor.itemTypes.effect.find((effect) => effect.getFlag('core', 'sourceId') === ITEM_UUID);\n    if (existing) {\n        await existing.delete();\n    } else {\n        await actor.createEmbeddedDocuments('Item', [source]);\n    }\n}","folder":null,"sort":0,"permission":{"default":0,"GkBqYHWkQyR3h49f":3},"flags":{"core":{"sourceId":"Macro.e5RGT2JGDD7NGmcV"}},"_id":"wtbpufDMVaOo0PDB"}
{"name":"Reaction used","type":"script","author":"GkBqYHWkQyR3h49f","img":"systems/pf2e/icons/actions/Reaction.webp","scope":"global","command":"const actors = canvas.tokens._hover? [canvas.tokens._hover.actor] : canvas.tokens.controlled.flatMap((token) => token.actor ?? []);\nif (actors.length === 0 && game.user.character) actors.push(game.user.character);\nif (actors.length === 0) {\n    const message = game.i18n.localize(\"PF2E.ErrorMessage.NoTokenSelected\");\n    return ui.notifications.error(message);\n}\n\nconst ITEM_UUID = \"Compendium.pf2e-color-effects.pf2e-color-effects.5ZFXnytwC9sK9gul\"; // Reaction used\nconst source = (await fromUuid(ITEM_UUID)).toObject();\nsource.flags = mergeObject(source.flags ?? {}, { core: { sourceId: ITEM_UUID } });\n\nfor (const actor of actors) {\n    const existing = actor.itemTypes.effect.find((e) => e.data.flags.core?.sourceId === ITEM_UUID);\n    if (existing) {\n        await existing.delete();\n    } else {\n        await actor.createEmbeddedDocuments(\"Item\", [source]);\n    }\n}","folder":null,"sort":0,"permission":{"default":0,"GkBqYHWkQyR3h49f":3},"flags":{"core":{"sourceId":"Macro.whAeYHFgSxh5m06H"}},"_id":"tpxE6YFbebHlMXc2"}
